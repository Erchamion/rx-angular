!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("rxjs"),require("rxjs/operators"),require("util"),require("@angular/core")):"function"==typeof define&&define.amd?define("@rx-angular/template",["exports","rxjs","rxjs/operators","util","@angular/core"],n):n(((e=e||self)["rx-angular"]=e["rx-angular"]||{},e["rx-angular"].template={}),e.rxjs,e.rxjs.operators,e.util,e.ng.core)}(this,(function(e,n,t,r,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var o=function(e,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(e,n)};function u(e,n){function t(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}var c=function(){return(c=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function a(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,i,o=t.call(e),u=[];try{for(;(void 0===n||n-- >0)&&!(r=o.next()).done;)u.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return u}function s(e){return function(n){return n.pipe(t.distinctUntilChanged(),t.map((function(n){var t=e[n];if(t)return t;throw new Error("Strategy "+n+" does not exist.")})))}}function d(e){var r=new n.ReplaySubject(1),i=r.pipe(t.distinctUntilChanged(),t.switchMap((function(e){return"string"==typeof e?n.of(e):e})),s(e.strategies)),o=new n.ReplaySubject(1),u=o.pipe(t.distinctUntilChanged()),c=!0,d=u.pipe(t.map((function(t){return null===t?n.of(null):c||(e.resetObserver.next(),void 0!==t)?(c=!1,t):n.of(void 0)})),t.filter((function(e){return void 0!==e})),t.switchMap((function(n){return n.pipe(t.distinctUntilChanged(),t.tap(e.updateObserver))})),t.withLatestFrom(i),t.tap((function(e){var n=a(e,2);n[0];return n[1].scheduleCD()})),t.catchError((function(e){return console.error(e),n.EMPTY})));return{nextPotentialObservable:function(e){o.next(e)},nextStrategy:function(e){r.next(e)},activeStrategy$:i,subscribe:function(){return(new n.Subscription).add(i.subscribe()).add(d.subscribe())}}}function f(){return globalThis||self||window}function l(e){var n=new WeakMap;return{getProps:t,setProps:function(e,r){var i=t(e);return Object.entries(r).forEach((function(e){var n=a(e,2),t=n[0],r=n[1];i[t]=r})),n.set(e,i),i}};function t(t){var r,i=e(t),o=n.get(t);return void 0!==o?r=o:(r={},Object.entries(i).forEach((function(e){var n=a(e,2),i=n[0],o=n[1];r[i]=function(e,n){return null!=e[n]}(t,i)?t[i]:o})),n.set(t,r)),r}}function p(e){return void 0!==f()["__zone_symbol__"+e]}var h=new WeakMap;function b(e){var n=h.get(e);if(void 0!==n)return n;var t=!1;function r(){}return r.apply=function(){return t=!0},e.runOutsideAngular(r),h.set(e,t),t}var v=null;function m(){return v=v||(p("Promise")?f().__zone_symbol__Promise.resolve():Promise.resolve())}function g(e,n){return n=n||f(),p(e)?n["__zone_symbol__"+e]:n[e]}function y(e,n){var t=e.eventListeners(n);if(t){var r=g("addEventListener",e).bind(e);t.forEach((function(t){e.removeEventListener(n,t),r(n,t)}))}}var w=l((function(e){return{numCoalescingSubscribers:0}}));function C(e){return void 0===e&&(e={}),{remove:function(){var n=w.getProps(e).numCoalescingSubscribers-1;w.setProps(e,{numCoalescingSubscribers:n})},add:function(){var n=w.getProps(e).numCoalescingSubscribers+1;w.setProps(e,{numCoalescingSubscribers:n})},isCoalescing:function(){return w.getProps(e).numCoalescingSubscribers>0}}}function x(e,t){var r=t||{};return function(t){return new n.Observable((function(i){var o=new n.Subscription;return o.add(t.subscribe(function(n,t){var i,o,u=C(r),c=function(){u.remove(),u.isCoalescing()||n.next(o)};return{complete:function(){i&&c(),n.complete()},error:function(e){return n.error(e)},next:function(n){o=n,i||(u.add(),i=e.subscribe({next:function(){c(),i=void 0},complete:function(){i&&(c(),i=void 0)}}),t.add(i))}}}(i,o))),o}))}}var S,k={now:function(){return 0},schedule:function(e,t,r){return n.from(m()).subscribe((function(){return e(r)}))}};!function(e){e.background="background",e.userBlocking="user-blocking",e.userVisible="user-visible"}(S||(S={}));var O="undefined"!=typeof window?window.scheduler||{postTask:function(e){Date.now();return new Promise((function(e){setTimeout((function(){console.error("postTask not implemented. Use setTimeout as fallback"),e()}),1)}))}}:function(){},P=function(e){function n(n){var t=e.call(this)||this;return t.work=n,t}return u(n,e),n.prototype.schedule=function(e,n){return this.closed?this:this._scheduler.schedule(this.work,n,e)},n}(n.Subscription);function M(e){return{now:function(){return n.asyncScheduler.now()},schedule:function(t,i,o){if(void 0===i&&(i={}),r.isObject(i)&&i.delay)return n.asyncScheduler.schedule(t,i.delay,o);i=c(c({},i),{priority:e});var u=new P(t);u._scheduler=this;O.postTask((function(){}),i).then((function(){try{t.call(u,o)}catch(e){throw u.unsubscribe(),e}}));return u.add((function(){throw new Error("not implemented")})),u}}}var R,V="undefined"!=typeof window?window.cancelIdleCallback||function(e){console.warn("Fake cancelIdleCallback used"),clearTimeout(e)}:function(){},j="undefined"!=typeof window?window.requestIdleCallback||function(e){console.warn("Fake requestIdleCallback used");var n=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-n))}})}),1)}:function(){},_=function(e){function n(n){var t=e.call(this)||this;return t.work=n,t}return u(n,e),n.prototype.schedule=function(e,n){return this.closed?this:D.schedule(this.work,n,e)},n}(n.Subscription),D={now:function(){return n.asyncScheduler.now()},schedule:function(e,t,r){if(t)return n.asyncScheduler.schedule(e,t,r);var i=new _(e),o=j((function(){try{e.call(i,r)}catch(e){throw i.unsubscribe(),e}}));return i.add((function(){return V(o)})),i}},E=new n.Observable((function(e){var n=0,t=g("requestAnimationFrame")((function(){e.next(++n)}));return function(){g("cancelAnimationFrame")(t)}})),A={now:function(){return 0},schedule:function(e,n,t){return E.subscribe((function(){return e(t)}))}};(R=e.SchedulingPriority||(e.SchedulingPriority={})).animationFrame="animationFrame",R.Promise="Promise",R.idleCallback="idleCallback",R.userBlocking="userBlocking",R.userVisible="userVisible",R.background="background",R.setInterval="setInterval";var T={animationFrame:n.animationFrameScheduler,Promise:n.asapScheduler,setInterval:n.asyncScheduler,idleCallback:D,userBlocking:M(S.userBlocking),userVisible:M(S.userVisible),background:M(S.background)};function I(e){if(!T.hasOwnProperty(e))throw new Error("priority "+e+" is not present in prioritiesMap");return T[e]}function L(e,n,t){void 0===t&&(t={});var r=C(t);r.isCoalescing()||(r.add(),n.subscribe((function(){!function(){if(r.remove(),!r.isCoalescing())e()}()})))}function F(e,n){return I(n).schedule((function(){return e()}))}function $(e,t,r){void 0===r&&(r={});L((function(){return F(e,t)}),n.from(m()),r)}function N(e){return{name:"native",renderMethod:e.cdRef.markForCheck,behavior:function(e){return e},scheduleCD:function(){e.cdRef.markForCheck()}}}function U(e){var n=function(){e.cdRef.detectChanges()};return{name:"localNative",renderMethod:n,behavior:function(e){return e.pipe()},scheduleCD:function(){return n()}}}function B(r){var i=n.from(m()),o=r.cdRef.context,u=e.SchedulingPriority.animationFrame,c=I(u),a=function(){r.cdRef.detectChanges()};return{name:"local",renderMethod:a,behavior:function(e){return e.pipe(x(i,o),t.observeOn(c))},scheduleCD:function(){return $(a,u,o)}}}function J(r){var i=n.from(m()),o=r.cdRef.context,u=e.SchedulingPriority.animationFrame,c=I(u),a=function(){r.cdRef.detectChanges()};return{name:"localCoalesce",renderMethod:a,behavior:function(e){return e.pipe(x(i,o),t.observeOn(c))},scheduleCD:function(){return $(a,u,o)}}}function Z(r){var i=n.from(m()),o=r.cdRef.context,u=e.SchedulingPriority.animationFrame,c=I(u),a=function(){r.cdRef.detectChanges()};return{name:"localCoalesceAndSchedule",renderMethod:a,behavior:function(e){return e.pipe(x(i,o),t.observeOn(c))},scheduleCD:function(){return $(a,u,o)}}}function q(r){var i=n.from(m()),o=r.cdRef.context,u=e.SchedulingPriority.animationFrame,c=I(u),a=function(){r.cdRef.reattach(),r.cdRef.detectChanges(),r.cdRef.detach()};return{name:"detach",renderMethod:a,behavior:function(e){return e.pipe(x(i,o),t.observeOn(c))},scheduleCD:function(){return $(a,u,o)}}}function W(r){var i=new n.Observable((function(e){n.from(O.postTask((function(){}),{priority:S.userVisible,delay:0})).subscribe(e)})),o=r.cdRef.context,u=e.SchedulingPriority.background,c=I(u),a=function(){r.cdRef.detectChanges()};return{name:"userVisible",renderMethod:a,behavior:function(e){return e.pipe(x(i,o),t.observeOn(c))},scheduleCD:function(){return $(a,u,o)}}}function z(r){var i=new n.Observable((function(e){n.from(O.postTask((function(){}),{priority:S.userVisible,delay:0})).subscribe(e)})),o=r.cdRef.context,u=I(e.SchedulingPriority.background),c=function(){r.cdRef.detectChanges()};return{name:"userBlocking",renderMethod:c,behavior:function(e){return e.pipe(x(i,o),t.observeOn(u))},scheduleCD:function(){L(c,i,o)}}}function G(r){var i=new n.Observable((function(e){n.from(O.postTask((function(){}),{priority:S.userVisible,delay:0})).subscribe(e)})),o=r.cdRef.context,u=I(e.SchedulingPriority.background),c=function(){r.cdRef.detectChanges()};return{name:"background",renderMethod:c,behavior:function(e){return e.pipe(x(i,o),t.observeOn(u))},scheduleCD:function(){L(c,i,o)}}}function Y(r){var i=n.from(m()),o=r.cdRef.context,u=e.SchedulingPriority.idleCallback,c=I(u),a=function(){r.cdRef.detectChanges()};return{name:"idleCallback",renderMethod:a,behavior:function(e){return e.pipe(x(i,o),t.observeOn(c))},scheduleCD:function(){return $(a,u,o)}}}function H(e){var n=function(){return i.ɵmarkDirty(e.cdRef.context)};return{name:"global",renderMethod:n,behavior:function(e){return e},scheduleCD:function(){return n()}}}function K(e){return c(c({noop:{name:"noop",renderMethod:function(){},behavior:function(e){return e},scheduleCD:function(){}},native:N(e)},function(e){return{global:H(e)}}(e)),function(e){return{local:B(e),localCoalesce:J(e),localCoalesceAndSchedule:Z(e),localNative:U(e),detach:q(e),userVisible:W(e),userBlocking:z(e),background:G(e),idleCallback:Y(e)}}(e))}var Q=function(){function e(e){var n=this;this.resetObserver={next:function(){n.renderedValue=void 0}},this.updateObserver={next:function(e){return n.renderedValue=e}},this.RenderAware=d({strategies:K({cdRef:e}),updateObserver:this.updateObserver,resetObserver:this.resetObserver}),this.subscription=this.RenderAware.subscribe()}return e.prototype.transform=function(e,n){var t=n||"local";return this.RenderAware.nextStrategy(t),this.RenderAware.nextPotentialObservable(e),this.renderedValue},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.ɵfac=function(n){return new(n||e)(i.ɵɵinjectPipeChangeDetectorRef())},e.ɵpipe=i.ɵɵdefinePipe({name:"push",type:e,pure:!1}),e}(),X=function(){function e(){}return e.ɵmod=i.ɵɵdefineNgModule({type:e}),e.ɵinj=i.ɵɵdefineInjector({factory:function(n){return new(n||e)},imports:[[]]}),e}();("undefined"==typeof ngJitMode||ngJitMode)&&i.ɵɵsetNgModuleScope(X,{declarations:[Q],exports:[Q]});var ee=function(){function e(e,n,t){var r=this;this.templateRef=n,this.viewContainerRef=t,this.ViewContext={$implicit:void 0,rxLet:void 0,$error:!1,$complete:!1},this.resetObserver={next:function(){r.embeddedView&&(r.ViewContext.$implicit=void 0,r.ViewContext.rxLet=void 0,r.ViewContext.$error=!1,r.ViewContext.$complete=!1)}},this.updateObserver={next:function(e){r.embeddedView||r.createEmbeddedView(),r.ViewContext.$implicit=e,r.ViewContext.rxLet=e},error:function(e){r.embeddedView||r.createEmbeddedView(),r.ViewContext.$error=!0},complete:function(){r.embeddedView||r.createEmbeddedView(),r.ViewContext.$complete=!0}},this.strategies=K({cdRef:e}),this.renderAware=d({strategies:this.strategies,resetObserver:this.resetObserver,updateObserver:this.updateObserver}),this.renderAware.nextStrategy("local")}return Object.defineProperty(e.prototype,"rxLet",{set:function(e){this.renderAware.nextPotentialObservable(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strategy",{set:function(e){this.renderAware.nextStrategy(e||"local")},enumerable:!0,configurable:!0}),e.ngTemplateContextGuard=function(e,n){return!0},e.prototype.ngOnInit=function(){this.subscription=this.renderAware.subscribe()},e.prototype.createEmbeddedView=function(){this.embeddedView=this.viewContainerRef.createEmbeddedView(this.templateRef,this.ViewContext)},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe(),this.viewContainerRef.clear()},e.ɵfac=function(n){return new(n||e)(i.ɵɵdirectiveInject(i.ChangeDetectorRef),i.ɵɵdirectiveInject(i.TemplateRef),i.ɵɵdirectiveInject(i.ViewContainerRef))},e.ɵdir=i.ɵɵdefineDirective({type:e,selectors:[["","rxLet",""]],inputs:{rxLet:"rxLet",strategy:["rxLetStrategy","strategy"]}}),e}(),ne=function(){function e(){}return e.ɵmod=i.ɵɵdefineNgModule({type:e}),e.ɵinj=i.ɵɵdefineInjector({factory:function(n){return new(n||e)}}),e}();("undefined"==typeof ngJitMode||ngJitMode)&&i.ɵɵsetNgModuleScope(ne,{declarations:[ee],exports:[ee]});var te=["scroll","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","load","pointerup","change","blur","focus","click","contextmenu","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","input"],re=function(){function e(e){this.el=e,this.subscription=new n.Subscription,this.events$=new n.BehaviorSubject(te)}return Object.defineProperty(e.prototype,"events",{set:function(e){e&&e.length>0?this.events$.next(e):this.events$.next(te)},enumerable:!0,configurable:!0}),e.prototype.reapplyEventListenersZoneUnPatched=function(e){var n=this;e.forEach((function(e){y(n.el.nativeElement,e)}))},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.ngAfterViewInit=function(){var e=this;this.subscription=this.events$.pipe(t.tap((function(n){return e.reapplyEventListenersZoneUnPatched(n)}))).subscribe()},e.ɵfac=function(n){return new(n||e)(i.ɵɵdirectiveInject(i.ElementRef))},e.ɵdir=i.ɵɵdefineDirective({type:e,selectors:[["","unpatch",""]],inputs:{events:["unpatch","events"]}}),e}(),ie=function(){function e(){}return e.ɵmod=i.ɵɵdefineNgModule({type:e}),e.ɵinj=i.ɵɵdefineInjector({factory:function(n){return new(n||e)}}),e}();("undefined"==typeof ngJitMode||ngJitMode)&&i.ɵɵsetNgModuleScope(ie,{declarations:[re],exports:[re]});var oe=function(){function e(){}return e.ɵmod=i.ɵɵdefineNgModule({type:e}),e.ɵinj=i.ɵɵdefineInjector({factory:function(n){return new(n||e)},imports:[ne,X,ie]}),e}();("undefined"==typeof ngJitMode||ngJitMode)&&i.ɵɵsetNgModuleScope(oe,{exports:[ne,X,ie]}),e.LetDirective=ee,e.LetModule=ne,e.PushModule=X,e.PushPipe=Q,e.TemplateModule=oe,e.UnpatchEventsDirective=re,e.UnpatchEventsModule=ie,e.apiZonePatched=p,e.coalesceAndSchedule=$,e.coalesceWith=x,e.createCoalesceManager=C,e.createPropertiesWeakMap=l,e.createRenderAware=d,e.envZonePatched=function(){return void 0!==f().Zone},e.getGlobalThis=f,e.getPostTaskScheduler=M,e.getScheduler=I,e.getStrategies=K,e.getUnpatchedResolvedPromise=m,e.getZoneUnPatchedApi=g,e.idleScheduler=D,e.isNgZone=b,e.isNoopNgZone=function(e){return!b(e)},e.isViewEngineIvy=function(){var e=f().ng;return void 0===e||void 0===e.probe},e.nameToStrategy=s,e.prioritySchedulerMap=T,e.renderChange=function(e){return function(n){return n.pipe(e.behavior,t.tap((function(n){return e.renderMethod()})))}},e.schedule=F,e.staticCoalesce=L,e.toObservableValue=function(e){return null==e?n.of(e):n.from(e)},e.unpatchEventListener=y,e.unpatchedAnimationFrameScheduler=A,e.unpatchedAsapScheduler=k,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=rx-angular-template.umd.min.js.map